# Kotitehtävä 4: Demonit
Kotitehtävät löytyy linkistä [Infra as Code 2023](https://terokarvinen.com/2023/configuration-management-2023-autumn/).

## x) Lue ja tiivistä

#### Karvinen 2023: [Salt Vagrant - automatically provision one master and two slaves](https://terokarvinen.com/2023/salt-vagrant/#infra-as-code---your-wishes-as-a-text-file):

#### Infra as Code - Your wishes as a text file
- `sudo mkdir -p /srv/salt/hello`: Komento luo hakemiston `hello` tielle `/srv/salt`, ja `-p` luo ylemmät hakemistot, jos ne eivät ole vielä olemassa.
- `sudoedit /srv/salt/hello/init.sls`: Komento luo/avaa tekstieditorin `/srv/salt/hello/init.sls`.

- Seuraava pätkä liitetään tekstieditoriin. Indentaatiolla on väliä YAML-syntaksissa, joten pitää varmistaa, että tiedostoon liitetään saman verran välilyöntejä (kaksi) ja ei tabeja. 
```
$ cat /srv/salt/hello/init.sls
/tmp/infra-as-code:
  file.managed

$ sudo salt '*' state.apply hello
```

#### top.sls - What Slave Runs What States
- `top.sls` tiedostoa voidaan käyttää määrittämään minionit pyörittämään tiettyjä tiloja.
- Seuraava konfiguraatio määrittää tilan `hello` [kaikille minioneille ('*' = kaikki minionit)](https://docs.saltproject.io/en/latest/topics/tutorials/walkthrough.html)
```
$ sudo salt '*' state.apply hello^C
$ sudoedit /srv/salt/top.sls
$ cat /srv/salt/top.sls
base:
  '*':
    - hello
```
- `sudo salt '*' state.apply`: Tällä voidaan liittää tila kaikille minioneille.

#### Salt contributors: [Salt overview](https://docs.saltproject.io/salt/user-guide/en/latest/topics/overview.html#rules-of-yaml)

#### Rules of YAML
- YAML on markup kieli, jonka työ on ottaa YAML datastruktuuri ja muuttaa se Python datastruktuuriksi Saltille.
- YAML syntaksi on tarkka, ja joitakin sen perussääntöjä ovat:
  - Datastruktuuri on muodossa `key: value`, esim. `ikä: 21`.
  - Siihen käytetään kaksoispistettä ja väliä, `: `.
  - Kaikki ovat case-sensitiivisiä.
  - Tabsit eivät ole sallittuja, saa käyttää vain välilyöntejä.
  - Kommentit alkavat risuaidalla `#`.

#### YAML simple structure
- YAML koostuu kolmesta peruselementtityypistä:
  1. Skalaareista: `key: value` voi olla numero, merkkijono tai boolean.
  2. Listoista: `key: ` voi olla lista, jos se jatketaan seuraavalta riviltä ranskalaisilla viivoilla jokaisen arvon jälkeen.
  3. 

## Lähteet
- https://docs.saltproject.io/en/latest/topics/tutorials/walkthrough.html
 ft
